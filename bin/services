#!/bin/bash

RED='\033[0;31m'
CLEAR='\033[0m'

main() {
  case "$1" in
    u | up)
      up $2
      ;;
    d | down)
      down $2
      ;;
    -h | --help)
      help
      ;;
    *)
      invalid-collection-msg $1
      help
      ;;
  esac
}

up() {
  local label='all'
  up-msg $label $1
  docker-compose up $1
}

down() {
  local label='all'
  down-msg $label
  docker-compose down
}

help() {
  cat <<TEXT
    SYNOPSIS
      services [collection] [-d]

    OPTIONS
      -d
        Detached mode: Run containers in the background

    COLLECTIONS
      u, up
        Brings up all containers
      d, down
        Brings down all containers

    EXAMPLES
      bin/services up
        Brings all service containers up
      bin/services up -d
        Brings all service containers up in detached mode
      bin/services down
        Brings all service containers down
TEXT
}

up-msg() {
  local insertion=""
  if [[ $2 == '-d' ]]; then
    insertion=" in detached mode"
  fi
  echo "Starting up $1 services$insertion..."
}

down-msg() {
  echo "Bringing down $1 services..."
}

invalid-collection-msg() {
  debugMessage "Invalid service collection: $1"
}

debugMessage() {
  echo -e "${RED}$1${CLEAR}"
}
